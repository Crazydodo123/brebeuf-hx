document.onmousemove=mouseMove,document.onmouseup=mouseUp;var swapPage,swapSection,actionPath="/action/",ajaxAllowed=!0,openedWindows={},openedMenus={},selectedGroup=null,zIndex=100;function customURLConverter(url,node,on_save,name){return"/static"===url.substring(0,7)&&(url=url),url}function makeDraggable(item,dragSource){item&&(setFocus(item),dragSource?(dragSource.onmousedown=function(ev){return dragObject=item,mouseOffset=getMouseOffset(this,ev),!1},dragSource.ontouchstart=function(ev){return ev.preventDefault(),setFocus(item),dragObject=item,mouseOffset=getTouchOffset(this,ev),!1},dragSource.ontouchmove=touchMove,dragSource.ontouchend=touchEnd,dragSource.ontouchcancel=touchEnd):item.onmousedown=function(ev){return setFocus(item),mouseOffset=getMouseOffset(this,ev),!1})}function getTouchOffset(target,ev){var oev=(ev=ev||window.event).originalEvent||ev,docPos=getPosition(target),mousePos=mouseCoords(oev.changedTouches[0]);return{x:mousePos.x-docPos.x,y:mousePos.y-docPos.y}}function touchMove(ev){(ev=ev||window.event).preventDefault();var oev=ev.originalEvent||ev,touchPos=mouseCoords(oev.changedTouches[0]);if(mouseCoordsXY=touchPos,dragObject)return dragObject.style.position="absolute",dragObject.style.top=touchPos.y-mouseOffset.y+"px",dragObject.style.left=touchPos.x-mouseOffset.x+"px",!1}function touchEnd(){dragObject=null}function openWindow(id,blackout,blackoutcloseable){if(disableApp&&"errorMsg"!=id&&"siteErrorMsg"!=id)popErrorSite("error.message.ie6");else{if(blackout){openedWindows[id]="blackout";var blackoutDiv=document.getElementById("blackout");blackoutDiv.style.display="block",setFocus(blackoutDiv),blackoutcloseable&&(blackoutDiv.onclick=function(){closeWindow(id)})}else openedWindows[id]=id;closeAllMenu();var tbar=document.getElementById(id+"_titlebar");tbar&&makeDraggable(document.getElementById(id),tbar.getElementsByClassName("windowTitle")[0]);var elem=document.getElementById(id);elem.style.display="block",setFocus(elem),centerElement(id),"managerImageWindow"==id?loadImagePreviews():"logsWindow"==id&&(document.getElementById("logsWindowIframe").src="logs-window")}}function openMenuWindow(sel,id,blackout,blackoutcloseable){if(disableApp&&"errorMsg"!=id&&"siteErrorMsg"!=id)popErrorSite("error.message.ie6");else{if(closeOtherWindows(id),blackout){openedWindows[id]="blackout";var blackoutDiv=document.getElementById("blackout");blackoutDiv.style.display="block",setFocus(blackoutDiv),blackoutcloseable&&(blackoutDiv.onclick=function(){closeWindow(id)})}else $(sel).hasClass("mg2_item_opened")?(openedWindows[id]="closed",$(sel).removeClass("mg2_item_opened"),$(sel).closest(".topMenuBar").removeClass("menuWindowOpened")):(openedWindows[id]=id,document.getElementById(id).style.height="100%",$(sel).addClass("mg2_item_opened"),$(sel).closest(".topMenuBar").addClass("menuWindowOpened"));var elem=document.getElementById(id);setFocus(elem,"505"),slideElement(id),"managerImageWindow"==id?loadImagePreviews():"logsWindow"==id&&(document.getElementById("logsWindowIframe").src="logs-window");var ajaxFrame=elem.querySelector(".mediaListAjax");ajaxFrame&&!$(ajaxFrame).hasClass("loaded")&&(ajaxFrame.src=ajaxFrame.getAttribute("data-src"))}}function closeOtherMenus(id){for(var i in openedMenus)openedMenus[i]&&"closed"!=openedMenus[i]&&openedMenus[i]!=id&&(slideElement(openedMenus[i]),openedMenus[i]="closed")}function closeOtherWindows(id){for(var i in openedWindows)openedWindows[i]&&"closed"!=openedWindows[i]&&openedWindows[i]!=id&&!$("#"+openedWindows[i]).hasClass("mvb_window")&&($(".mg2_item_opened").removeClass("mg2_item_opened"),slideElement(openedWindows[i]),openedWindows[i]="closed")}function highlightMenu(menuItem,id,on){on?openedMenus[id]||(menuItem.className="topMenuItem"):menuItem.className="topMenuItem topMenuItemH"}function centerElement(elementId){var div=document.getElementById(elementId),w=div.offsetWidth,h=div.offsetHeight,dimensions=getViewPaneSize(),scrollOffset=getScrollXY();$(div).css("position","absolute");var offsetTop=parseInt((dimensions[1]-h)/2+scrollOffset[1]);offsetTop<50&&(offsetTop=50),div.style.left=(dimensions[0]-w)/2+scrollOffset[0]+"px",div.style.top=offsetTop+"px",setFocus(div)}function slideElement(elementId){var div=document.getElementById(elementId),dimensions=getMenuPaneSize(),divWidth=document.documentElement.clientWidth-dimensions[0],$iframe=$(div).find("iframe");0==$iframe.length||"closed"!=openedWindows[elementId]||$iframe.hasClass("loaded")||$iframe.css("display","none"),div.style.maxWidth&&""!==div.style.maxWidth||(div.style.maxWidth=div.style.width),div.style.width=divWidth+"px",div.style.left=dimensions[0]+"px",$(div).toggle("slide",{direction:"left"},500,(function(){0!=$iframe.length&&"closed"!=openedWindows[elementId]&&$iframe.css("display","block")}))}function getScrollXY(){var scrOfX=0,scrOfY=0;return"number"==typeof window.pageYOffset?(scrOfY=window.pageYOffset,scrOfX=window.pageXOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(scrOfY=document.body.scrollTop,scrOfX=document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(scrOfY=document.documentElement.scrollTop,scrOfX=document.documentElement.scrollLeft),[scrOfX,scrOfY]}function getViewPaneSize(){var myWidth=0,myHeight=0;return"number"==typeof window.innerWidth?(myWidth=window.innerWidth,myHeight=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(myWidth=document.documentElement.clientWidth,myHeight=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(myWidth=document.body.clientWidth,myHeight=document.body.clientHeight),[myWidth,myHeight]}function getMenuPaneSize(){var myWidth=0,myHeight=0;return"number"==typeof document.getElementById("topMenuBar").innerWidth?(myWidth=document.getElementById("topMenuBar").innerWidth,myHeight=document.getElementById("topMenuBar").innerHeight):document.documentElement&&(document.getElementById("topMenuBar").clientWidth||document.getElementById("topMenuBar").clientHeight)&&(myWidth=document.getElementById("topMenuBar").clientWidth,myHeight=document.getElementById("topMenuBar").clientHeight),[myWidth,myHeight]}function closeAllMenu(){for(var i in openedMenus)openedMenus[i]&&(openedMenus[i]=!1,document.getElementById(i).style.display="none",document.getElementById("parent_"+i).className="topMenuItem")}function closeTextWindow(){closeWindow("textWindow"+currentTextId),currentTextId=null}function closeWindow(id){openedWindows[id]="closed";var removeBlackout=!0;for(var windowId in openedWindows)"closed"!=openedWindows[windowId]&&setFocus(document.getElementById(windowId)),"blackout"==openedWindows[windowId]&&(removeBlackout=!1);"imageWindow"==id?window.location.reload(!1):(removeBlackout&&(document.getElementById("blackout").style.display="none"),document.getElementById(id).style.display="none",$(".topMenuBar").removeClass("menuWindowOpened"),$(".mg2_item_opened").removeClass("mg2_item_opened"))}function closeMenuWindow(id){var removeBlackout=!0;for(var windowId in openedWindows)"closed"!=openedWindows[windowId]&&setFocus(document.getElementById(windowId)),"blackout"==openedWindows[windowId]&&(removeBlackout=!1);"imageWindow"==id?window.location.reload(!1):!removeBlackout||$("#"+id).hasClass("mvb_window")?(document.getElementById("blackout").style.display="none",document.getElementById(id).style.display="none"):($(".topMenuBar").removeClass("menuWindowOpened"),$(".mg2_item_opened").removeClass("mg2_item_opened"),slideElement(id)),openedWindows[id]="closed"}function ajax(url,method,noload,returnVar,usePost,reqHeader){var xmlHttp;ajaxAllowed=!0;try{xmlHttp=new XMLHttpRequest}catch(e){try{xmlHttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{xmlHttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return!1}}}pageLoaded&&!noload&&ajaxBlackout(!0),xmlHttp.onreadystatechange=function(){try{if(4==xmlHttp.readyState&&200==xmlHttp.status){if(!ajaxAllowed)return;var response=xmlHttp.responseText;-1!=response.indexOf("void~!~")||(-1!=response.indexOf("error-")?admlog?(popError("errorMessageAjax"),document.getElementById("errorMessageAjax").innerHTML=response.substring(6)):(popErrorSite("errorMessageAjaxSite"),document.getElementById("errorMessageAjaxSite").innerHTML=response.substring(6)):-1!=response.indexOf("%$")?method(response.split("%$"),returnVar):method(response,returnVar)),pageLoaded&&!noload&&ajaxBlackout(!1)}}catch(e){pageLoaded&&!noload&&ajaxBlackout(!1)}};var noCache="cache="+Math.random(),nonCacheUrl=-1!=url.indexOf("?")?url+"&":url+"?";if(usePost){if(xmlHttp.open("POST",nonCacheUrl+noCache,!0),reqHeader)for(var k in reqHeader)xmlHttp.setRequestHeader(k,reqHeader[k]);else xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlHttp.send()}else xmlHttp.open("GET",nonCacheUrl+noCache,!0),xmlHttp.send(null)}function ajaxCache(url,method,noload,returnVar,usePost,reqHeader){var xmlHttp;ajaxAllowed=!0;try{xmlHttp=new XMLHttpRequest}catch(e){try{xmlHttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{xmlHttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return!1}}}if(pageLoaded&&!noload&&ajaxBlackout(!0),usePost)if(xmlHttp.open("POST",url,!0),reqHeader)for(var k in reqHeader)xmlHttp.setRequestHeader(k,reqHeader[k]);else xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");else xmlHttp.open("GET",url,!0),xmlHttp.send(null);xmlHttp.onreadystatechange=function(){try{if(4==xmlHttp.readyState&&200==xmlHttp.status){if(!ajaxAllowed)return;var response=xmlHttp.responseText;-1!=response.indexOf("void~!~")||(-1!=response.indexOf("error-")?admlog?(popError("errorMessageAjax"),document.getElementById("errorMessageAjax").innerHTML=response.substring(6)):(popErrorSite("errorMessageAjaxSite"),document.getElementById("errorMessageAjaxSite").innerHTML=response.substring(6)):-1!=response.indexOf("%$")?method(response.split("%$"),returnVar):method(response,returnVar)),pageLoaded&&!noload&&ajaxBlackout(!1)}}catch(e){pageLoaded&&!noload&&ajaxBlackout(!1)}}}function ajaxSubmitE(formId){ajaxSubmit(document.getElementById(formId))}function ajaxSubmit(form){var inputs=form.getElementsByTagName("input"),isAjax=!1,str="?",first=!0;for(var i in inputs){var name=inputs[i].name,value=inputs[i].value;"ajax"==name&&"true"==value&&(isAjax=!0),first?first=!1:str+="&",str+=name+"="+value}if(isAjax){ajax(form.action+str,openStructureTree);try{swapPage=null,swapSection=null,selectedBoundPageId=null,closeWindow("makeMainPage"),closeWindow("makeFloatPage"),closeWindow("lockPage"),closeWindow("unlockPage"),closeWindow("boundPage")}catch(exception){}return!1}form.submit()}function voidAjax(){ajaxAllowed=!1,ajaxBlackout(!1)}function ajaxBlackout(on,load){if(load&&(pageLoaded=load),!on){var div=document.getElementById("ajaxBlackout");return div&&(div.style.display="none"),void ajaxLoader(on)}alignBlackout()}function alignBlackout(on){try{var blackoutDiv=document.getElementById("ajaxBlackout"),view=getViewPaneSize();-1!=navigator.userAgent.indexOf("Firefox")?(blackoutDiv.style.display="block",document.height<view[1]?blackoutDiv.style.height="100%":blackoutDiv.style.height=document.height+"px",blackoutDiv.style.width=document.width+"px",setFocus(blackoutDiv)):(blackoutDiv.style.display="block",document.body.scrollHeight+110<view[1]?blackoutDiv.style.height="100%":blackoutDiv.style.height=document.body.scrollHeight+"px",blackoutDiv.style.width=document.body.scrollWidth+"px",setFocus(blackoutDiv))}catch(exception){}}function ajaxLoader(on,adminLoad){var el=document.getElementById("ajaxLoaderBar4");el&&(!adminLoad||on&&adminLoad&&el.hasAttribute("data-on"))&&(el.style.display=on?"block":"none")}function addCookie(key,value){var date=new Date;date.setTime(date.getTime()+31536e6);var expires="; expires="+date.toGMTString();document.cookie=key+"="+value+"; path=/"+expires}function componentMouseOver(id,isTyped,hover){var componentDiv=document.getElementById("componentDiv_"+id),bulkdiv=document.getElementById("mg2BulkImage"+id);hover?(isTyped&&(document.getElementById("componentDivDel_"+id).style.display="block",document.getElementById("componentDivSwapUp_"+id).style.display="block",document.getElementById("componentDivSwapDown_"+id).style.display="block",bulkdiv&&-1==navigator.appVersion.indexOf("MSIE")&&(bulkdiv.style.display="block")),componentDiv.style.border="1px dashed red"):(isTyped&&(document.getElementById("componentDivDel_"+id).style.display="none",document.getElementById("componentDivSwapUp_"+id).style.display="none",document.getElementById("componentDivSwapDown_"+id).style.display="none",bulkdiv&&(bulkdiv.style.display="none")),componentDiv.style.border="1px dashed black")}function deleteComponentMaster(){var name=document.getElementById("compMasterNameInput").value;confirm('Are you sure that you wish to delete the component "'+name+'"?')&&(window.location="/action/masterComponentCreate?delete&name="+name)}function popComponentSelect(id,allowed,name){var allowedList=allowed.split(","),selectDiv=document.getElementById("componentPreviews-select");for(var i in document.getElementById("nameSelectComponent").value=allowedList[0],document.getElementById("compPreview_"+allowedList[0]+"_firstChild").className="selected",selectDiv.innerHTML="",allowedList){var n=allowedList[i];0!=i&&document.getElementById("compPreview_"+n+"_firstChild")&&(document.getElementById("compPreview_"+n+"_firstChild").className=""),selectDiv.innerHTML=selectDiv.innerHTML+document.getElementById("compPreview_"+n).innerHTML}document.getElementById("componentIdInput").value=id,document.getElementById("componentNameInput").value=name,openWindow("componentSelect",!0)}function submitText(id){if(id){var pName=document.getElementById("textFormPageName"+id).value,l=document.getElementById("textFormLang"+id).value,newText=tinyMCE.get("text"+id).getContent();ajaxBlackout(!0),$.ajax({type:"POST",url:"/action/updateText",data:{textId:id,lang:l,pageName:pName,text:newText},success:submitTextComplete(id)})}else document.getElementById("formSaveText"+currentTextId).submit()}function submitTextComplete(response){ajaxBlackout(!1),document.getElementById("displayTextInnerWindow"+response).style.textAlign="left",document.getElementById("displayTextInnerWindow"+response).innerHTML=tinyMCE.get("text"+response).getContent(),closeWindow("textWindow"+response)}function selectComponent(type){for(var elems=document.getElementById("componentPreviews-select").getElementsByClassName("selected"),i=0;i<elems.length;i++)elems[i].className="";document.getElementById("nameSelectComponent").value=type,document.getElementById("compPreview_"+type+"_firstChild").className="selected"}function popDeleteComponent(id,name){openWindow("deleteComponent",!0),document.getElementById("componentIdDeleteInput").value=id,document.getElementById("componentNameDeleteInput").value=name}$(window).on("load",(function(){$(".mvb_window").on("click",(function(){setFocus(this)})),$(".master_icon").on("click",(function(){$(this).parent().toggleClass("masterMessage_opened")})),getCurrentOgValues()}));var componentSwapFirstDiv=null,componentSwapSecondDiv=null,componentSwapPos=null,componentSwapNextPos=null,componentSwapFirstClass=null,componentSwapSecondClass=null;function swapComponents(name,id,up,pageId,max){var index=id.indexOf("-Component")+10;componentSwapPos=id.substring(index),componentSwapNextPos=up?parseInt(componentSwapPos)-1:parseInt(componentSwapPos)+1;var firstId="componentDiv_"+name+"-Component"+componentSwapPos,secondId="componentDiv_"+name+"-Component"+componentSwapNextPos;if(1==componentSwapPos&&up||componentSwapPos==max&&!up)return componentSwapPos=null,void(componentSwapNextPos=null);try{componentSwapFirstDiv=document.getElementById(firstId),componentSwapSecondDiv=document.getElementById(secondId),componentSwapFirstClass=componentSwapFirstDiv.className,componentSwapSecondClass=componentSwapSecondDiv.className,componentMouseOver(id,!0,!1),componentMouseOver(id.split("Component"+componentSwapPos).join("Component"+componentSwapNextPos),!0,!1),ajax(actionPath+"swapComponent?pageId="+pageId+"&componentId="+id+"&name="+name+"&up="+up,swapComponentSuccess())}catch(exception){}}function swapComponentSuccess(){var temp=componentSwapFirstDiv.innerHTML.split("Component"+componentSwapPos).join("Component"+componentSwapNextPos);componentSwapFirstDiv.innerHTML=componentSwapSecondDiv.innerHTML.split("Component"+componentSwapNextPos).join("Component"+componentSwapPos),componentSwapSecondDiv.innerHTML=temp,componentSwapFirstDiv.className=componentSwapSecondClass,componentSwapSecondDiv.className=componentSwapFirstClass,componentSwapFirstDiv=null,componentSwapSecondDiv=null,componentSwapPos=null,componentSwapNextPos=null,componentSwapFirstClass=null,componentSwapSecondClass=null}function popError(key){-1!=key.indexOf("errorMessageAjax")?(document.getElementById("errorMessageAjax").style.display="block",document.getElementById("errorMessageDivOriginal").style.display="none"):(document.getElementById("errorMessageAjax").style.display="none",document.getElementById("errorMessageDivOriginal").style.display="block",ajax("/action/getLabel?key="+key,popErrorComplete))}function popErrorComplete(response){document.getElementById("errorMessageDivOriginal").innerHTML=response,openWindow("errorMsg",!0)}function popErrorSite(key){-1!=key.indexOf("errorMessageAjaxSite")?(document.getElementById("errorMessageAjaxSite").style.display="block",document.getElementById("errorMessageSite").style.display="none",openWindow("siteErrorMsg",!0)):(document.getElementById("errorMessageAjaxSite").style.display="none",document.getElementById("errorMessageSite").style.display="block",ajax("/action/getLabel?key="+key,popErrorSiteComplete))}function popErrorSiteComplete(response){document.getElementById("errorMessageSite").innerHTML=response,openWindow("siteErrorMsg",!0)}function submitForm(id){var form=document.getElementById(id),inputs=form.getElementsByTagName("input"),validForm=!0;for(i in inputs){if("text"==inputs[i].type&&""===inputs[i].value&&-1===inputs[i].className.indexOf("skip")){validForm=!1,$(inputs[i]).addClass("error"),$(inputs[i]).on("mouseup",(function(){$(this).removeClass("error")})),$("html, body").animate({scrollTop:$(inputs[i]).offset().top});break}if("text"==inputs[i].type&&inputs[i].name.startsWith("tag")&&inputs[i].value.startsWith("/"))return void popError("error.message.url.slash")}validForm?form.submit():null!=document.getElementById("errorMessageAjax")&&popError("error.message.emptyForm")}function accessSelectGroup(sel,groupId){$(".access_group_selected").removeClass("access_group_selected"),$(sel).addClass("access_group_selected"),document.getElementById("accessDropZone").innerHTML="",document.getElementById("userAccessFrame").innerHTML=document.getElementById("-BAKuserAccessFrame").innerHTML.split("-BAK").join(""),selectedGroup=groupId,ajax(actionPath+"getGroupUsers?groupId="+groupId,accessSelectGroupResponse,!0)}function accessSelectGroupResponse(list){if("void"!=list){var container=document.getElementById("accessDropZone");for(var item in list){var arr=list[item].split(","),str=document.getElementById("userAcessFrame_members").firstElementChild.cloneNode(!0);item!=list.length-1&&($(str).attr("id","AJAXLOAD-userItem_"+arr[0]),$(str).find("a[data-user='link']").attr("href","javascript:accessSwapUp('"+arr[0]+"')"),$(str).find("a[data-user='link']").prepend(arr[1]),container.innerHTML=container.innerHTML+""+str.outerHTML)}}}function addUserGroup(userId){null!=selectedGroup?ajax(actionPath+"addGroupUser?userId="+userId+"&groupId="+selectedGroup,accessCompleteSwapDown,!0):popError("error.message.noselectedgroup")}function accessSwapDown(id){swapDownId=id,addUserGroup(id)}function accessSwapUp(id){swapUpId=id,openWindow("accessGroupUserDelete",!0)}function accessCompleteSwapDown(response){var item=document.getElementById("userItem_"+swapDownId);document.getElementById("accessDropZone").appendChild(item),document.getElementById("a_user_"+swapDownId).href="javascript:accessSwapUp('"+swapDownId+"');",$("#a_user_"+swapDownId).find(".mg2_add_to_group").addClass("mg2_remove_from_group"),$("#a_user_"+swapDownId).find(".mg2_add_to_group").removeClass("mg2_add_to_group"),openWindow("accessGroupUserConfirm")}function accessCompleteSwapUp(response){var id="AJAXLOAD-userItem_"+swapUpId;try{document.getElementById("accessDropZone").removeChild(document.getElementById(id))}catch(e){id="userItem_"+swapUpId;var item=document.getElementById(id);document.getElementById("userAccessFrame").appendChild(item),document.getElementById("a_user_"+swapUpId).href="javascript:accessSwapDown('"+swapUpId+"');"}$("#"+id).find(".mg2_remove_from_group").addClass("mg2_add_to_group"),$("#"+id).find(".mg2_remove_from_group").removeClass("mg2_remove_from_group"),closeWindow("accessGroupUserDelete")}var currentUserPageId=null;function accessPerPage(pageId){currentUserPageId=pageId,document.getElementById("acessUserPageTitle").innerHTML=document.getElementById("pageName_"+pageId).innerHTML,ajax(actionPath+"getUserPage?pageId="+pageId,accessPerPageComplete)}function accessPerPageComplete(list){if(openWindow("accessUserPage",!0),$("#userPerPageList .accessItem").each((function(){$(this).attr("id",$(this).attr("id").replace("invisible_","")),$(this).find("a").attr("id",$(this).find("a").attr("id").replace("invisible_","")),$(this).css("display","")})),1!=list[0].length){var container=document.getElementById("userPerPageDropList");for(var item in container.innerHTML="",list){var arr=list[item].split(","),str=document.getElementById("pageAcessFrame_members").firstElementChild.cloneNode(!0);item!=list.length-1&&(0!=$("#userPerPageList #userPage_"+arr[0]).length&&($("#userPerPageList #userPage_"+arr[0]).css("display","none"),$("#userPerPageList #userPage_"+arr[0]).find("a").attr("id","userPageLink_invisible_"+arr[0]),$("#userPerPageList #userPage_"+arr[0]).attr("id","userPage_invisible_"+arr[0])),$(str).attr("id","userPage_"+arr[0]),$(str).find("a[data-user='link']").attr("id","userPageLink_"+arr[0]),$(str).find("a[data-user='link']").attr("href","javascript:accessDeleteUserPage('"+arr[0]+"')"),$(str).find("a[data-user='link'] .mg2_remove_from_group").before(arr[1]),container.innerHTML=container.innerHTML+""+str.outerHTML)}}else document.getElementById("userPerPageDropList").innerHTML=""}var accessUserPageUserId=null;function accessAddUserPage(userId){accessUserPageUserId=userId,ajax(actionPath+"addUserPage?userId="+userId+"&pageId="+currentUserPageId,accessAddUserPageComplete,!0)}function accessAddUserPageComplete(response,listToDrop){if(null==listToDrop&&(listToDrop="userPerPageDropList"),0!=$("#"+listToDrop+" #userPage_"+accessUserPageUserId).length&&"userPerPageDropList"==listTopDrop);else{var item=document.getElementById("userPage_"+accessUserPageUserId),dropZone=document.getElementById(listToDrop);document.getElementById("userPageLink_"+accessUserPageUserId);"userPerPageDropList"==listToDrop?(dropZone.appendChild(item.cloneNode(!0)),$("#userPerPageList #userPageLink_"+accessUserPageUserId).attr("id","userPageLink_invisible_"+accessUserPageUserId),$("#userPerPageList #userPage_"+accessUserPageUserId).attr("id","userPage_invisible_"+accessUserPageUserId),$("#userPerPageList #userPage_invisible_"+accessUserPageUserId).css("display","none"),$("#userPageLink_"+accessUserPageUserId).attr("href","javascript:accessDeleteUserPage('"+accessUserPageUserId+"')"),$("#userPageLink_"+accessUserPageUserId).find(".mg2_add_to_group").addClass("mg2_remove_from_group"),$("#userPageLink_"+accessUserPageUserId).find(".mg2_add_to_group").removeClass("mg2_add_to_group")):($(item).remove(),$("#userPerPageList #userPageLink_invisible_"+accessUserPageUserId).attr("id","userPageLink_"+accessUserPageUserId),$("#userPerPageList #userPage_invisible_"+accessUserPageUserId).attr("id","userPage_"+accessUserPageUserId),$("#userPerPageList #userPage_"+accessUserPageUserId).css("display","block"))}accessUserPageUserId=null}function accessDeleteUserPage(userId){accessUserPageUserId=userId,ajax(actionPath+"deleteUserPage?userId="+userId+"&pageId="+currentUserPageId,accessDeleteUserPageComplete,!0)}function accessDeleteUserPageComplete(){accessAddUserPageComplete("","userPerPageList")}function enablepageWindow(enable,pageId){enable?(openWindow("disablePage",!0),document.getElementById("disablePageInput").value=pageId):(openWindow("enablePage",!0),document.getElementById("enablePageInput").value=pageId)}function makeFloatPageWindow(id,ajaxAction){document.getElementById("floatPageIdInput").value=id,document.getElementById("floatPageAjax").value="true",ajaxAction&&openWindow("makeFloatPage",!0)}function delpageWindow(pageId){openWindow("deletePage",!0),document.getElementById("deletePageInput").value=pageId}function enablesectionWindow(enable,sectionId){enable?(openWindow("disableSection",!0),document.getElementById("disableSectionInput").value=sectionId):(openWindow("enableSection",!0),document.getElementById("enableSectionInput").value=sectionId)}function delsectionWindow(sectionId){openWindow("deleteSection",!0),document.getElementById("deleteSectionInput").value=sectionId}function makeHomeWindow(id,ajaxAction){openWindow("makeMainPage",!0),document.getElementById("makeMainPageId").value=id,ajaxAction&&(document.getElementById("mainPageAjax").value="true")}function setFocus(selectedWindow,ref){zIndex+=1,null!=ref&&(zIndex=parseInt(ref)+1),selectedWindow.style.zIndex=zIndex}var selectedBoundPageId=null;function selectPageBound(id){document.getElementById("treeRow_page_"+id).style.backgroundColor="#6FB7F2",selectedBoundPageId?(document.getElementById("treeRow_page_"+selectedBoundPageId).style.backgroundColor="transparent",selectedBoundPageId=selectedBoundPageId==id?null:id):selectedBoundPageId=id,selectedBoundPageId&&(document.getElementById("boundPageIdSourceInput").value=selectedBoundPageId)}function modifyLabel(key,domElement,maxlength,lang){document.getElementById("currentLabelKeyInput").value=key;var input=document.getElementById("currentLabelValueInput");input.value=$(domElement).text(),input.maxLength=maxlength,currentEditDom=domElement,_mg2ManagerLang=lang,openWindow("addSiteLabel"),document.getElementById("currentLabelValueInput").focus()}function submitLabelModified(text){currentEditDom.innerHTML=decodeURIComponent(text).split("+").join(" "),currentEditDom=null,closeWindow("addSiteLabel")}function submitModifyLabel(reset){var value=document.getElementById("currentLabelValueInput").value,empty=""===value;ajax(actionPath+"addSiteLabel?lang="+_mg2ManagerLang+"&key="+document.getElementById("currentLabelKeyInput").value+"&value="+(reset||empty?"":encodeURIComponent(value)),submitLabelModified)}function mg2_modifyLabelCustom(sel,label,langs,reset){$(sel).is(":checkbox")||"select-one"===$(sel).prop("type")||"object"!=typeof sel||""!=$(sel).attr("value").trim()||""!=$(sel).val().trim()||null!=reset||(reset=!0);var val=sel;"object"!=typeof sel||$(sel).is(":checkbox")||"select-one"===$(sel).prop("type")?$(sel).is(":checkbox")?val=sel.checked:"select-one"===$(sel).prop("type")&&(val=sel.options[sel.selectedIndex].value):val=$(sel).val();for(var l=JSON.parse(langs.trim()),i=0;i<l.length;i++)ajax(actionPath+"addSiteLabel?lang="+l[i].lang+"&key="+label+"&value="+(reset?"`````":encodeURIComponent(val)),submitLabelModified)}function openStructureTree(sel){try{closeWindow("siteRedirections")}catch(exception){}$(sel).hasClass("mg2_item_opened")?openMenuWindow(sel,"structureTree",!1):ajax("/action/getStructureTree",(function(response){structureTreeDisplay(response,sel)}),!0)}function structureTreeDisplay(response,sel){var element=document.getElementById("structureTree");element&&element.parentNode.removeChild(element),document.getElementById("ajaxWindowsAdd").innerHTML+=response,openMenuWindow(sel,"structureTree",!1),$(".tree_sections_container").sortable({stop:function(event,ui){var curr=$(ui.item).find(".treeRow_section").attr("id");ajax("/action/swapSection?ajax=true&sectionId="+curr.substring(curr.lastIndexOf("_")+1)+"&targetPosition="+ui.item.index(),(function(){}),!0),$("#tree_refresh").css("display","block")}}).disableSelection();var sortableOut=0;$(".tree_pages_container,.mg2_tree_third_level").sortable({connectWith:".tree_pages_container,.mg2_tree_third_level",items:".treeRow_page",start:function(event,ui){sortableOut=0,$(ui.item).hasClass("treeRow_page_main")||null==document.getElementById("tree_no_floating")||$(".treeRow_floating").addClass("treeRow_floating_over")},over:function(event,ui){$(ui.item).hasClass("treeRow_page_main")||($(this).parent().hasClass("treeRow_floating")||$(this).addClass("tree_pages_container_over"),$(this).parent().hasClass("treeRow_floating")&&null!=document.getElementById("tree_no_floating")&&(document.getElementById("tree_no_floating").style.display="none"))},out:function(event,ui){$(this).removeClass("tree_pages_container_over"),$(this).parent().hasClass("treeRow_floating")&&0==$(this).find(".treeRow_page").length&&null!=document.getElementById("tree_no_floating")&&(document.getElementById("tree_no_floating").style.display="block")},remove:function(event,ui){($(ui.item).hasClass("treeRow_page_main")||($(ui.item).parent().parent().hasClass("treeRow_floating")||$(ui.item).parent().hasClass("mg2_tree_third_level"))&&0!=$(ui.item).find(".mg2_tree_third_level .treeRow_page").length)&&(sortableOut=1,$(this).sortable("cancel"))},stop:function(event,ui){if($(".mg2_tree_third_level_over").removeClass("mg2_tree_third_level_over"),$(".treeRow_floating_over").removeClass("treeRow_floating_over"),0===sortableOut){0==$(".treeRow_floating").find(".treeRow_page").length?document.getElementById("tree_no_floating").style.display="block":document.getElementById("tree_no_floating").style.display="none";var curr=$(ui.item).attr("id"),currId=curr.substring(curr.lastIndexOf("_")+1);if($(ui.item).parent(".tree_pages_container").parent().hasClass("treeRow_floating"))ajax("/action/makeFloatPage?pageId="+currId+"&ajax=true",(function(){}),!0);else if($(ui.item).parent().hasClass("mg2_tree_third_level")){var currBound=$(ui.item).parent(".mg2_tree_third_level").parent().attr("id");ajax("/action/swapPage?ajax=true&pageId="+currId+"&boundId="+currBound.substring(currBound.lastIndexOf("_")+1)+"&targetPosition="+ui.item.index(),(function(){}),!0)}else{var currSection=$(ui.item).parent(".tree_pages_container").parent(".mg2_tree_section").find(".treeRow_section").attr("id");ajax("/action/swapPage?ajax=true&pageId="+currId+"&sectionId="+currSection.substring(currSection.lastIndexOf("_")+1)+"&targetPosition="+ui.item.index(),(function(){}),!0)}$("#tree_refresh").css("display","block")}}}).disableSelection()}function displayMG2Block(sel,id,toggleClass){$(sel).hasClass(toggleClass)?($(sel).removeClass(toggleClass),$("#"+id).slideUp()):($(sel).addClass(toggleClass),$("#"+id).slideDown())}function popMenu(parent,id){$(parent).hasClass("mg2_opened_menu")?displayMainMenu():($(parent).addClass("mg2_opened_menu"),$("#"+id).addClass("mg2_opened_sub_menu"),$(".topMenuItem:not(.mg2_opened_menu)").addClass("mg2_closed_menu"))}function displayMainMenu(){$(".mg2_opened_menu").removeClass("mg2_opened_menu"),$(".mg2_closed_menu").removeClass("mg2_closed_menu"),$(".mg2_opened_sub_menu").removeClass("mg2_opened_sub_menu")}function openSiteRedirections(sel){try{closeWindow("structureTree")}catch(exception){}$(sel).hasClass("mg2_item_opened")?openMenuWindow(sel,"siteRedirections",!1):ajax("/action/siteRedirections",(function(response){siteRedirectionsDisplay(response,sel)}))}function siteRedirectionsDisplay(response,sel){var element=document.getElementById("siteRedirections");element&&element.parentNode.removeChild(element),document.getElementById("ajaxWindowsAdd").innerHTML+=response,openMenuWindow(sel,"siteRedirections",!1)}function addRedirection(){var src=document.getElementById("siteRedirectionSourceURL").value,target=document.getElementById("siteRedirectionTargetURL").value,sel=document.getElementById("siteRedirectionRedirection");ajax("/action/siteRedirections?redirection="+sel.options[sel.selectedIndex].value+"&sourceUrl="+encodeURIComponent(src)+"&targetUrl="+encodeURIComponent(target),addRedirectionComplete)}function addRedirectionComplete(){closeWindow("siteRedirections"),window.setTimeout(openSiteRedirections,250)}function deleteRedirection(id){ajax("/action/siteRedirections?id="+id,addRedirectionComplete)}var xmlEditorCurrentFilename=null,codeMirror=null;function openXMLEditor(filename){xmlEditorCurrentFilename=filename,ajax("/action/xmlEditor?filename="+encodeURI(filename),xmlEditorLoad)}function xmlEditorLoad(response){var element=document.getElementById("xmlEditor");element&&element.parentNode.removeChild(element),document.getElementById("ajaxWindowsAdd").innerHTML+=response,openWindow("xmlEditor"),codeMirror=CodeMirror.fromTextArea(document.getElementById("xmlEditorContent"))}function xmlEditorSave(){var ta=encodeURIComponent(codeMirror.getValue());$.ajax({type:"POST",url:"/action/xmlEditor",data:{save:"true",filename:encodeURI(xmlEditorCurrentFilename),content:ta},success:xmlEditorComplete})}function xmlEditorComplete(response){xmlEditorCurrentFilename=null,closeWindow("xmlEditor")}function displayFullImage(uri,url,w,h){var protocol=window.location.href.substring(0,window.location.href.indexOf("//")+2);document.getElementById("imageManagerPreviewDivImgInfos").innerHTML='<span class="mg2_image_copy" ></span><input type="text" disabled="true" class="mg2_url" value="'+protocol+url+uri+'" />',""!==w&&""!==h&&(document.getElementById("imageManagerPreviewDivImgInfos").innerHTML+='<div style="margin:5px 5px 5px 35px;">'+w+'px <span style="font-weight:bold;">x</span> '+h+"px </div>"),document.getElementById("imageManagerPreviewDivImg").innerHTML='<img src="'+protocol+url+uri+'" alt=""/><div style="position:absolute;width:0;height:0;top:0;right;0;background-color:black;"></div>',openWindow("managerImageWindowFullSize"),$(".mg2_image_copy").on("click",(function(event){$(".mg2_url").removeAttr("disabled"),$(".mg2_url").select(),$(".mg2_url").attr("disabled","true");try{var successful=document.execCommand("copy");successful&&$(".mg2_success").fadeIn((function(){window.setTimeout((function(){$(".mg2_success").fadeOut()}),3e3)}))}catch(err){console.log("Oops, unable to copy")}})),$(".mg2_image_copy").mouseup((function(e){e.preventDefault()}))}var _currentSendFile=null;function sendFile(file){_currentSendFile=file,openWindow("sendFileConfirm",!0)}function sendFileGo(){var email=document.getElementById("sendFileEmailAddress").value;ajax("/action/sendFileEmail?email="+encodeURIComponent(email)+"&file="+encodeURIComponent(_currentSendFile),sendFileComplete)}function sendFileComplete(){_currentSendFile=null,closeWindow("sendFileConfirm")}function dragAndMoveFile(currSrc,target){ajax("/action/moveFile?filename="+encodeURIComponent(currSrc)+"&targetDirectory="+target,(function(){}),!0)}function openMediaList(sel,id,pageName){$("#"+id).css("height","100%"),$("#"+id+" iframe").attr("src",pageName),openMenuWindow(sel,id,!1)}function refreshPageWebsite(){window.location.reload()}function textWindow(id,localId,componentId){null!=currentTextId&&closeTextWindow(),currentTextId=id,document.getElementById("textFormLocalId"+id).value=localId,document.getElementById("textFormComponentId"+id).value=componentId;var form=document.getElementById("formSaveText"+id);""!=id?(document.getElementById("textFormTextId"+id).value=id,form.action=actionPath+"updateText"):form.action=actionPath+"createText",openWindow("textWindow"+id)}var deleteMediaFileName=null,deleteMediaFileCurrDir=null;function deleteFile2(fileName,dir){deleteMediaFileName=fileName,deleteMediaFileCurrDir=dir,openWindow("deleteFile",!0)}function deleteFileConfirm(){$.ajax({url:"/action/deleteMedia",type:"post",data:{fileName:encodeURIComponent(deleteMediaFileCurrDir)+"/"+encodeURIComponent(deleteMediaFileName)},success:deleteFileRefresh})}function deleteFileRefresh(){document.getElementById("mediaListingIframe").src="mediaListingManager?directory="+deleteMediaFileCurrDir+"&noCache="+Math.random(),deleteMediaFileName=null,deleteMediaFileCurrDir=null,closeWindow("deleteFile")}function SetCaretAtEnd(elem){var elemLen=elem.value.length;if(document.selection){elem.focus();var oSel=document.selection.createRange();oSel.moveStart("character",-elemLen),oSel.moveStart("character",elemLen),oSel.moveEnd("character",0),oSel.select()}else(elem.selectionStart||"0"==elem.selectionStart)&&(elem.selectionStart=elemLen,elem.selectionEnd=elemLen,elem.focus())}function displayNextMonth(calendarData){var prefix=eventsAdminGlobal?"admin-events-mm-":"events-mm-",containerId=eventsAdminGlobal?"adminEventsContainer":"eventsContainer";if(document.getElementById(prefix+""+currentMMHolder+"-"+currentYYHolder).style.display="none",document.getElementById(containerId).innerHTML+=calendarData.split("Z$").join("&"),firstSelected)try{document.getElementById("td-"+firstSelectedDate[2]+"-"+firstSelectedDate[1]+"-"+firstSelectedDate[0]).className="eventsTdAdminSelected",firstSelected=!1}catch(exception){}if(secondSelected)try{document.getElementById("td-"+secondSelectedDate[2]+"-"+secondSelectedDate[1]+"-"+secondSelectedDate[0]).className="eventsTdAdminSelected",secondSelected=!1}catch(exception){}currentMMHolder=null,currentYYHolder=null}function getFileToUpload(id){document.getElementById(id).click()}function subFileUploaded(obj,id){for(var file=obj,str="",i=0;i<file.files.length;++i)str+=file.files.item(i).name,i<file.files.length-1&&(str+=", ");document.getElementById(id).innerHTML=str}function resizeCMSMenu(action){var windowWidth,id="topMenuBar",menu=document.getElementById(id),menuWidth=250;switch(action){case"minimize":menu.className=id+" "+id+"Mini",menuWidth=78;break;case"hide":-1===menu.className.indexOf("Hidden")&&(menu.className+=" "+id+"Hidden"),menuWidth=0;break;default:menu.className=id}for(var id in windowWidth=document.documentElement.clientWidth-menuWidth,openedWindows)"closed"!==openedWindows[id]&&$("#"+id).animate({left:menuWidth+"px",width:windowWidth+"px"},300);ajax("/action/sessionVariables?key="+id+"&value="+menu.className,(function(){}),!0)}function hijackUser(){var username=prompt("Username?");window.location="/action/login?forward=/&hijack=true&username="+username}function bulkImageWindow(count,componentId){document.getElementById("bulkUploadImgCount").innerHTML=count,document.getElementById("bulkImgCount-input").value=count,document.getElementById("bulkImg-componentId").value=componentId;try{document.getElementById("bulkImg-directory").value=_componentsBulk[componentId].join(","),openWindow("mgBulkImager")}catch(exception){location.reload(!0)}}function uploadImage(id,localId,componentId,directory,pageId,rule,width,height){var iframe=document.getElementById("uploadImageIframe"),source="/crop?content&";""!=id&&(source+="mediaId="+id+"&"),source+="localId="+localId,source+="&componentId="+componentId,source+="&directory="+directory,source+="&pageId="+pageId,source+="&rule="+rule,source+="&ruleWidth="+width,source+="&ruleHeight="+height,source+="&noCache="+Math.random(),iframe.src=source,openWindow("imageWindow",!0)}function getMessageIO(){ajaxCache("/action/messages?inbox=true",(function(response){for(var nodes=(new DOMParser).parseFromString(response,"application/xml").firstElementChild.children,ms="",i=0;i<nodes.length;i++){var node=nodes[i],text=node.getAttribute("content");text&&""!==text&&"null"!==text&&(ms+=text+"\n"),ajaxCache("/action/messages?ajax=true&delete=true&id="+node.getAttribute("id"),voidAjax,!0)}""!==ms&&alert(ms),setTimeout(getMessageIO,6e3)}),!0)}function sendMessageIO(name,message){var u=name,m=message;u&&""!==u.trim()||(u=prompt("Username")),m||(m=prompt("Message")),u&&""!==u.trim()&&m&&ajax("/action/messages?ajax=true&active=true&username="+u.trim()+"&content="+m,(function(response){alert(response)}),!0)}function getClassList(el){if(el.classList)return el.classList;var cls=el.getAttribute("class")||"",list=[];return(list=cls.trim().split(" ")).value=cls,list}function decodeCMSEncoding(str){return str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=(str=str.replace(/\\xE0/g,"à")).replace(/\\xE2/g,"â")).replace(/\\xE3/g,"ã")).replace(/\\xE4/g,"ä")).replace(/\\xE5/g,"å")).replace(/\\xE7/g,"ç")).replace(/\\xE9/g,"é")).replace(/\\xE8/g,"è")).replace(/\\xEA/g,"ê")).replace(/\\xEB/g,"ë")).replace(/\\xEE/g,"î")).replace(/\\xEF/g,"ï")).replace(/\\xF1/g,"ñ")).replace(/\\xF2/g,"ò")).replace(/\\xF3/g,"ó")).replace(/\\xF4/g,"ô")).replace(/\\xF6/g,"ö")).replace(/\\xF9/g,"ù")).replace(/\\xFB/g,"û")).replace(/\\xC0/g,"À")).replace(/\\xC2/g,"Â")).replace(/\\xC7/g,"Ç")).replace(/\\xC8/g,"È")).replace(/\\xC9/g,"É")).replace(/\\xCA/g,"Ê")).replace(/\\xCB/g,"Ë")).replace(/\\xCE/g,"Î")).replace(/\\xCF/g,"Ï")).replace(/\\xD1/g,"Ñ")).replace(/\\xD4/g,"Ô")).replace(/\\xD9/g,"Ù")).replace(/\\xDB/g,"Û")}function getCurrentOgValues(){var imageMeta=$("html head").find('meta[property="og:image"]'),titleMeta=$("html head").find('meta[property="og:title"]'),descMeta=$("html head").find('meta[property="og:description"]');$(".mg2-page-og-image-preview").length>0&&void 0!==imageMeta&&$(".mg2-page-og-image-preview").attr("src",imageMeta.attr("content")),$(".mg2-page-og-curr-desc .val").length>0&&void 0!==descMeta&&descMeta.attr("content").length>0?$(".mg2-page-og-curr-desc .val").html(descMeta.attr("content")):$(".mg2-page-og-curr-desc").remove(),$(".mg2-page-og-curr-title .val").length>0&&void 0!==titleMeta&&titleMeta.attr("content").length>0?$(".mg2-page-og-curr-title .val").html(titleMeta.attr("content").split(" | ")[0]):$(".mg2-page-og-curr-title").remove()}function updateLabelWindow(info){$("#formAddSiteLabelInfo").text(info)}
//# sourceMappingURL=../maps/core-new.min.js.map
